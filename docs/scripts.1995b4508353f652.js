var selectedGenes=[],decrease=[],increase=[],allGene=[],for_each_node=function(e,t,n){"use strict";var s;for(s=0;s<e.length;s+=1)t.call(n,e[s])},js_comm_globals={};function loadFloatingProteinWindowCoor(e,t,n,s,u,i,c){"use strict";var l=i-n/2-800;l<50&&(l=50);var o=c-30-400;o<20&&(o=30);var a=js_comm_globals.web_cgi_dir+"/showiteminfo?";a+="&noAction=1&search_string_link=1",a+="&node="+e,a+="&taskId="+js_comm_globals.task_id,a+="&referer=embedded_svg",a+="&node_type=P";var d=js_comm_globals.web_images_dir+"/loading_bigrotation.gif";return hideFloatingDiv("fpWindowDiv"),displayFloatingDiv("fpWindowDiv",u,n,s,-1,-1,l,o,"#E6E6E6",null,a,d),!1}function loadFloatingProteinWindow(e,t,n,s,u,i,c){"use strict";var l=0,o=0;if(c){var a=document.getElementById("stringEmbedded"+selectedGenes[0]);a&&(l=(d=a.getBoundingClientRect()).left,o=d.top);var d,f=document.getElementById("network_object");f&&(l=(d=f.getBoundingClientRect()).left-l,o=d.top-o)}return e.stopPropagation(),loadFloatingProteinWindowCoor(t,n,s,u,i,e.clientX+l,e.clientY+o)}function loadFloatingInteractionWindowCoor(e,t,n,s,u){}function edge_popup(e,t,n,s,u){}function toggle_structure_section(e,t){"use strict";var s=document.getElementById("current.section.count."+t),l=document.getElementById("max.section.count."+t).textContent,o=Number(s.textContent)+e;if(o>0&&o<=Number(l)){s.textContent=String(o);var a=1;for(a=1;a<=Number(l);a+=1)document.getElementById("protein.section.group."+a).style.visibility=a===o?"visible":"hidden";var m=document.getElementById("domainoffset"+t+"r"+o).textContent;document.getElementById("smart_domain_illustration_image").setAttribute("x",m)}return!0}function getSTRING(e,t,n,s,u,i){js_comm_globals.web_cgi_dir=e+/cgi/,js_comm_globals.web_images_dir=e+/images/,selectedGenes=n,decrease=u,increase=s,allGene=i;var c=document.getElementById("stringEmbedded"+selectedGenes[0]);console.log(selectedGenes),console.log("stringEmbedded"+selectedGenes[0]),console.log(c),console.log(t);var l=new FormData(l);for(let a in t){let d=t[a];"identifiers"==a?(proteins_str=d.join("%0d"),l.append(a,proteins_str)):l.append(a,d)}var o=new XMLHttpRequest;o.onreadystatechange=function(){o.readyState==XMLHttpRequest.DONE&&(c.innerHTML=o.responseText,init_network_interactive_functionalities(),update_network_coordinates_at_server=function(){})},o.open("POST",e+"/api/interactive_svg/network",!0),o.send(l)}function submit_current_network(){document.getElementById("string_embedded_linkout").submit()}function getSTRINGpost(e,t){js_comm_globals.web_cgi_dir=e+/cgi/,js_comm_globals.web_images_dir=e+/images/;var n=document.getElementById("stringEmbedded"+selectedGenes[0]),s=new FormData(s);for(let i in t)s.append(i,t[i]);var u=new XMLHttpRequest;u.onreadystatechange=function(){u.readyState==XMLHttpRequest.DONE&&(n.innerHTML=u.responseText,init_network_interactive_functionalities(),update_network_coordinates_at_server=function(){})},u.open("POST",e+"/api/interactive_svg/network",!0),u.send(s)}js_comm_globals.session_id="",js_comm_globals.task_id="";var svgWidth=450,svgHeight=450,parent_document=null,network_document=null,network_offset_x=0,network_offset_y=0,svg_metainfo_nodes={},svg_network_positions_dirty=0;function setMovableNode(e){"use strict";e.has_moved=!1,e.is_in_front=!1,e.is_being_dragged=!1,e.original_event_target=null,e.onmousedown=moveObjectMDown,e.ontouchstart=moveObjectTDown,e.onmouseupCallback=function(t){return e.original_event_target=t.currentTarget,moveObjectMUp.apply(e,arguments)},e.onmousemoveCallback=function(t){return e.original_event_target=t.currentTarget,moveObjectMMove.apply(e,arguments)},e.ontouchendCallback=function(t){return e.original_event_target=t.currentTarget,moveObjectTUp.apply(e,arguments)},e.ontouchmoveCallback=function(t){return e.original_event_target=t.currentTarget,moveObjectTMove.apply(e,arguments)}}function initiate_move(e,t,n){"use strict";e.movStartX=t,e.movStartY=n,e.movStartObject={x:e.node.x,y:e.node.y},e.has_moved=!1,e.is_in_front=!1,e.is_being_dragged=!0;var s=document.getElementById("network_object");if(s){var u=s.getBoundingClientRect();network_offset_x=u.left,network_offset_y=u.top}}function moveObjectMDown(e){return initiate_move(this,e.clientX,e.clientY),parent_document.addEventListener("mousemove",this.onmousemoveCallback,!1),parent_document.addEventListener("mouseup",this.onmouseupCallback,!1),parent_document!==network_document&&network_document.addEventListener("mousemove",this.onmousemoveCallback,!1),parent_document!==network_document&&network_document.addEventListener("mouseup",this.onmouseupCallback,!1),!1}function moveObjectMMove(e){"use strict";if(!this.is_being_dragged)return!1;if(this.is_in_front||(this.parentNode.appendChild(this),this.is_in_front=!0),0==svgHeight||0==svgWidth){var t=network_document.getElementById("svg_network_image");svgWidth=t.width,svgHeight=t.height}var n=e.clientX,s=e.clientY;parent_document!==network_document&&this.original_event_target==parent_document&&(n-=network_offset_x,s-=network_offset_y),this.original_event_target=null,(n!=this.movStartX||s!=this.movStartY)&&(this.has_moved=!0),this.node.x=this.movStartObject.x+n-this.movStartX,this.node.y=this.movStartObject.y+s-this.movStartY,this.node.x<this.node.radius/2?this.node.x=this.node.radius/2:this.node.x+this.node.radius/2>svgWidth&&(this.node.x=svgWidth-this.node.radius/2),this.node.y<this.node.radius/2?this.node.y=this.node.radius/2:this.node.y+this.node.radius/2>svgHeight&&(this.node.y=svgHeight-this.node.radius/2),this.setAttribute("transform","translate("+(this.node.x-this.node.ix)+","+(this.node.y-this.node.iy)+")");for(var u=0;u<this.node.links.length;++u){var i=this.node.links[u],c=i.n2.x-i.n1.x,l=i.n2.y-i.n1.y,o=Math.sqrt(c*c+l*l);0==o?(c=0,l=0):(c/=o,l/=o);var a=-l,d=c;i.elm.setAttribute("x1",i.n1.x+c*i.x1+a*i.y1),i.elm.setAttribute("y1",i.n1.y+l*i.x1+d*i.y1),i.elm.setAttribute("x2",i.n2.x+c*i.x2+a*i.y2),i.elm.setAttribute("y2",i.n2.y+l*i.x2+d*i.y2)}return svg_network_positions_dirty=1,!1}function moveObjectMUp(e){"use strict";return this.is_being_dragged=!1,parent_document.removeEventListener("mousemove",this.onmousemoveCallback,!1),parent_document.removeEventListener("mouseup",this.onmouseupCallback,!1),parent_document!==network_document&&network_document.removeEventListener("mousemove",this.onmousemoveCallback,!1),parent_document!==network_document&&network_document.removeEventListener("mouseup",this.onmouseupCallback,!1),!1}function moveObjectTDown(e){"use strict";if(0==e.targetTouches.length)return!0;e.preventDefault();var t=e.targetTouches[0];return this.touchId=t.identifier,e.clientX=t.clientX,e.clientY=t.clientY,initiate_move(this,e.clientX,e.clientY),parent_document.addEventListener("touchmove",this.ontouchmoveCallback,!1),parent_document.addEventListener("touchend",this.ontouchendCallback,!1),parent_document!==network_document&&network_document.addEventListener("touchmove",this.ontouchmoveCallback,!1),parent_document!==network_document&&network_document.addEventListener("touchend",this.ontouchendCallback,!1),!1}function moveObjectTMove(e){"use strict";e.preventDefault();for(var t=0;t<e.touches.length&&e.touches[t].identifier!=this.touchId;++t);if(t>=e.touches.length)return moveObjectTUp(e);var n=e.touches[t];return null==n||(e.clientX=n.clientX,e.clientY=n.clientY,moveObjectMMove.apply(this,arguments)),!1}function moveObjectTUp(e){"use strict";this.is_being_dragged=!1,parent_document.removeEventListener("touchmove",this.ontouchmoveCallback,!1),parent_document.removeEventListener("touchend",this.ontouchendCallback,!1),parent_document!==network_document&&network_document.removeEventListener("touchmove",this.ontouchmoveCallback,!1),parent_document!==network_document&&network_document.removeEventListener("touchend",this.ontouchendCallback,!1);for(var t=0;t<e.changedTouches.length&&e.changedTouches[t].identifier!=this.touchId;++t);var n=e.changedTouches[t];return null==n||(e.clientX=n.clientX,e.clientY=n.clientY,handle_network_node_click.apply(this,arguments)),!1}function update_network_coordinates_at_server(e,t){"use strict";if(!svg_network_positions_dirty)return!1;svg_network_positions_dirty=0;var n=svgWidth+"#"+svgHeight+"#";for(var s in svg_metainfo_nodes){var u=svg_metainfo_nodes[s];n=n+s+":"+u.x+":"+u.y+"#"}var i={taskId:e,coordinates_info:n,timeout:t};if(typeof Worker<"u")new Worker(js_comm_globals.web_js_dir+"/network_state_communication_worker_"+js_comm_globals.js_script_version+".js").postMessage(i);else{var l=new XMLHttpRequest;l.open("POST",js_comm_globals.web_cgi_dir+"/updatenetworkcoordinates",!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.send("taskId="+i.taskId+"&node_coordinates="+i.coordinates_info)}updateCpnonceHash()}function handle_network_edge_click(e){"use strict";e.preventDefault();var t=this.id.split(".");hideFloatingDiv("fpWindowDiv"),edge_popup(e,t[1],t[2],"Interaction",!0),e.stopPropagation()}function handle_network_node_click(e){"use strict";if(!this.has_moved){var t=this.id.split(".");window.parent.postMessage(this.getAttribute("data-safe_div_label"),"*");var n=t[1],s=this.getAttribute("data-action_option"),u=Number(this.getAttribute("data-exp_width")),i=Number(this.getAttribute("data-exp_height")),c=this.getAttribute("data-safe_div_label");hideFloatingDiv("fpWindowDiv"),loadFloatingProteinWindow(e,n,s,u,i,c,!0),e.stopPropagation()}}function init_network_interactive_functionalities(e){"use strict";var t=document.getElementById("network_object");if(t?(network_document=t.contentDocument,parent_document=document):(network_document=document,parent_document=network_document),network_document){var n=network_document.getElementById("svg_network_image");if(n){var s=n.getBoundingClientRect();svgWidth=s.width,svgHeight=s.height;var u=network_document.querySelectorAll(".nwnodecontainer");null!==u&&for_each_node(u,function(o){var a=o.id,d=o.getElementsByTagName("text");for(const r of d){var f=r.innerHTML.toUpperCase();selectedGenes.includes(f)&&r.setAttribute("font-weight","bold"),increase.includes(f)?r.setAttribute("fill","#8d0606"):decrease.includes(f)?r.setAttribute("fill","#4f78a4"):allGene.includes(f)?r.setAttribute("fill","#ce8080"):r.setAttribute("fill","#676666")}svg_metainfo_nodes[a]={},svg_metainfo_nodes[a].elm=o,svg_metainfo_nodes[a].elm.node=svg_metainfo_nodes[a],svg_metainfo_nodes[a].x=Number(o.getAttribute("data-x_pos")),svg_metainfo_nodes[a].y=Number(o.getAttribute("data-y_pos")),svg_metainfo_nodes[a].radius=Number(o.getAttribute("data-radius")),svg_metainfo_nodes[a].ix=svg_metainfo_nodes[a].x,svg_metainfo_nodes[a].iy=svg_metainfo_nodes[a].y,svg_metainfo_nodes[a].links=[],setMovableNode(o),o.addEventListener("click",handle_network_node_click)});var i=network_document.querySelectorAll(".nwlinkwrapper");null!==i&&for_each_node(i,function(o){o.addEventListener("click",handle_network_edge_click)});var c=network_document.querySelectorAll(".nw_edge");null!==c&&for_each_node(c,function(o){var a=o.id.split("."),f="node."+a[2],r={};r.n1=svg_metainfo_nodes["node."+a[1]],r.n2=svg_metainfo_nodes[f],r.elm=o,r.x1=Number(o.getAttribute("x1")),r.x2=Number(o.getAttribute("x2")),r.y1=Number(o.getAttribute("y1")),r.y2=Number(o.getAttribute("y2"));var v=r.x2-r.x1,m=r.y2-r.y1,g=Math.sqrt(v*v+m*m);0==g?(v=0,m=0):(v/=g,m/=g),v=Math.abs(v),m=Math.abs(m),r.n1.ix>r.n2.ix&&(v*=-1),r.n1.iy>r.n2.iy&&(m*=-1);var _,y=-m,b=v;r.x1-=r.n1.x,r.y1-=r.n1.y,_=r.x1*y+r.y1*b,r.x1=r.x1*v+r.y1*m,r.y1=_,r.x2-=r.n2.x,r.y2-=r.n2.y,_=r.x2*y+r.y2*b,r.x2=r.x2*v+r.y2*m,r.y2=_,r.n1.links.push(r),r.n2.links.push(r)}),window.setInterval(function(){update_network_coordinates_at_server(js_comm_globals.task_id,400)},1e3)}}}window.addEventListener("load",init_network_interactive_functionalities);var originalDivHtml={},hideDelaySeconds=-1,bfd_parent_document=null,bfd_network_document=null,bfd_network_offset_x=0,bfd_network_offset_y=0,objDiv=null,mouseDownOffsetX=0,mouseDownOffsetY=0;function displayFloatingDivImp(e,t,n,s,u,i,c,l,o,a){if("visible"!=document.getElementById(e).style.visibility){var d=-1,f=-1;"number"==typeof window.pageYOffset?(f=window.pageYOffset,d=window.pageXOffset):document.body&&(document.body.scrollLeft||document.body.scrollTop)?(f=document.body.scrollTop,d=document.body.scrollLeft):document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(f=document.documentElement.scrollTop,d=document.documentElement.scrollLeft);var r=1e4;"number"==typeof window.innerWidth?(r=window.innerWidth,window):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(r=document.documentElement.clientWidth,document):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(r=document.body.clientWidth,document),null!=i&&(i-=f),null!=u&&(u+=d),null!=n&&n>0&&(document.getElementById(e).style.width=n+"px"),null!=s&&s>0&&(document.getElementById(e).style.height=s+"px"),null!=u&&u>0&&(document.getElementById(e).style.left=u+"px"),null!=i&&i>0&&(document.getElementById(e).style.top=i+"px"),document.getElementById(e).style.zIndex=1e5;var m=document.getElementById(e).innerHTML;originalDivHtml[e]=m;var g="movable_div_resize_wrapper_"+e,y='<table class="movable_div_wrapper" id="'+g+'"><tr><td>',b="";null!=t&&(b='<table class="movable_div_title_container" style="background:'+c+';"><tr><td class="movable_div_title_bar" data-parent_div_to_move_id="'+e+'">'+t+'</td><td class="movable_div_closelink_wrapper"><a class="floatingdivcloselink" title="click to close" href="#" onclick="hideFloatingDiv(\''+e+'\');return false;"><img src="'+js_comm_globals.web_images_dir+'/floating_close_icon.png" width="16" height="16"/></a></td></tr></table>'),document.getElementById(e).innerHTML=y+b+m+"</td></tr></table>",document.getElementById(e).style.display="block",document.getElementById(e).style.visibility="visible";var _=document.getElementById(e).offsetWidth;if(null!=n&&n>0&&(_=n),document.getElementById(g).style.width=_+"px",o){var h=u-(_-a)/2;h-d+_>r-20&&(h=d+r-(20+_)),h<20+d&&(h=20+d),Math.abs(h-u)>3&&(document.getElementById(e).style.left=h+"px")}initFloatingDivMovementOption(),null!==l&&l>0&&(timerDivId=e,hideDelaySeconds=l,startFDT())}}function displayFloatingDiv(e,t,n,s,u,i,c,l,o,a,d,f){null!=d&&""!=d&&ajaxCallForFD(e,t,u,i,c,l,o,a,d);var r=600;null!=n&&n>0&&(r=n);var v=350;null!=s&&s>0&&(v=s),null!=f&&""!=f&&(document.getElementById(e).innerHTML="<div style='width:"+r+"px;height:"+v+"px;display:table'><div style='text-align:center; display:table-cell; vertical-align:middle;'><img src='"+f+"' style='vertical-align: middle;'></img></div></div>"),displayFloatingDivImp(e,t,u,i,c,l,o,a)}function displayFloatingDivAjaxResponse(e,t,n,s,u,i,c,l,o){if(4==e.readyState&&200==e.status){var a=document.getElementById(t).offsetWidth;hideFloatingDiv(t),document.getElementById(t).innerHTML=e.responseText,displayFloatingDivImp(t,n,s,u,i,c,l,o,1,a)}}function ajaxCallForFD(e,t,n,s,u,i,c,l,o){var a=getRequestObject();if(a.onreadystatechange=function(){displayFloatingDivAjaxResponse(a,e,t,n,s,u,i,c,l)},o.length<=1024)a.open("GET",o,!0),a.send(null);else{var d=o.indexOf("?"),f=o.substr(d+1),r=o.substr(0,d);a.open("POST",r,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.setRequestHeader("Content-length",f.length),a.setRequestHeader("Connection","close"),a.send(f)}}function hideFloatingDiv(e){if(null!=e&&""!=e){var t=document.getElementById(e);null!=t&&"none"!=t.style.display&&(null!=originalDivHtml[e]&&(t.innerHTML=originalDivHtml[e]),t.style.visibility="hidden",t.style.display="none")}}function movable_div_initiate_move(e,t,n){"use strict";null!=e.parent_div_to_move&&(mouseDownOffsetX=t-parseInt(e.parent_div_to_move.style.left),mouseDownOffsetY=n-parseInt(e.parent_div_to_move.style.top));var s=document.getElementById("network_object");if(s){var u=s.getBoundingClientRect();bfd_network_offset_x=u.left,bfd_network_offset_y=u.top}}function movable_div_MDown_handler(e){"use strict";return movable_div_initiate_move(this,e.clientX,e.clientY),bfd_parent_document.addEventListener("mousemove",this.onmousemoveCallback,!1),bfd_parent_document.addEventListener("mouseup",this.onmouseupCallback,!1),bfd_parent_document!==bfd_network_document&&bfd_network_document.addEventListener("mousemove",this.onmousemoveCallback,!1),bfd_parent_document!==bfd_network_document&&bfd_network_document.addEventListener("mouseup",this.onmouseupCallback,!1),!1}function movable_div_MMove_handler(e){"use strict";if(null!==this.parent_div_to_move){var t=e.clientX-mouseDownOffsetX,n=e.clientY-mouseDownOffsetY;bfd_parent_document!==bfd_network_document&&e.currentTarget==bfd_network_document&&(t+=bfd_network_offset_x,n+=bfd_network_offset_y),this.parent_div_to_move.style.left=t+"px",this.parent_div_to_move.style.top=n+"px"}return!1}function movable_div_MUp_handler(e){"use strict";return bfd_parent_document.removeEventListener("mousemove",this.onmousemoveCallback,!1),bfd_parent_document.removeEventListener("mouseup",this.onmouseupCallback,!1),bfd_parent_document!==bfd_network_document&&bfd_network_document.removeEventListener("mousemove",this.onmousemoveCallback,!1),bfd_parent_document!==bfd_network_document&&bfd_network_document.removeEventListener("mouseup",this.onmouseupCallback,!1),!1}function movable_div_TDown_handler(e){"use strict";return!1}function movable_div_TMove_handler(e){"use strict";return!1}function movable_div_TUp_handler(e){"use strict";return!1}function registerMovableDivTitleBar(e){"use strict";e.has_moved=!1,e.is_being_dragged=!1,e.original_event_target=null,e.parent_div_to_move=null,e.hasAttribute("data-parent_div_to_move_id")&&(e.parent_div_to_move=document.getElementById(e.getAttribute("data-parent_div_to_move_id"))),e.onmousedown=movable_div_MDown_handler,e.ontouchstart=movable_div_TDown_handler,e.onmousemoveCallback=function(t){return e.original_event_target=t.currentTarget,movable_div_MMove_handler.apply(e,arguments)},e.ontouchmoveCallback=function(t){return e.original_event_target=t.currentTarget,movable_div_TMove_handler.apply(e,arguments)},e.onmouseupCallback=function(t){return e.original_event_target=t.currentTarget,movable_div_MUp_handler.apply(e,arguments)},e.ontouchendCallback=function(t){return e.original_event_target=t.currentTarget,movable_div_TUp_handler.apply(e,arguments)}}function initFloatingDivMovementOption(){var e=document.getElementById("network_object");if(e?(bfd_network_document=e.contentDocument,bfd_parent_document=document):(bfd_network_document=document,bfd_parent_document=bfd_network_document),bfd_network_document){var t=bfd_parent_document.querySelectorAll(".movable_div_title_bar");null!==t&&for_each_node(t,function(s){registerMovableDivTitleBar(s)})}}var timerTimeSecondsFDT=0,timerIDFDT=0,tStartFDT=null,timerDivId=null;function updateTimerFDT(){timerIDFDT&&(clearTimeout(timerIDFDT),clockID=0),tStartFDT||(tStartFDT=new Date);var e=new Date,t=e.getTime()-tStartFDT.getTime();e.setTime(t),timerTimeSecondsFDT=e.getSeconds(),hideDelaySeconds<=timerTimeSecondsFDT&&(stopFDT(),hideFloatingDiv(timerDivId)),timerIDFDT=setTimeout("updateTimerFDT()",1e3)}function startFDT(){tStartFDT=new Date,timerTimeSecondsFDT=0,timerIDFDT=setTimeout("updateTimerFDT()",1e3)}function stopFDT(){timerIDFDT&&(clearTimeout(timerIDFDT),timerIDFDT=0),tStartFDT=null}function resetFDT(){tStartFDT=null,timerTimeSecondsFDT=0}function ajaxInsertInElement(e,t){var n=getRequestObject();n.onreadystatechange=function(){showResponseText(n,t)},n.open("GET",e,!0),n.send(null)}function ajaxSimpleCall(e){var t=getRequestObject();t.open("GET",e,!0),t.send(null)}function getRequestObject(){return window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest?new XMLHttpRequest:null}function showResponseText(e,t){4==e.readyState&&200==e.status&&htmlInsert(t,e.responseText)}function htmlInsert(e,t){document.getElementById(e).innerHTML=t}